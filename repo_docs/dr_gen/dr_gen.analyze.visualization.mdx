---
title: dr_gen
---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/visualization.py"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

# <kbd>module</kbd> `analyze.visualization`
Simplified plotting module for dr_gen analysis.

Replaces plot_utils.py + common_plots.py with direct matplotlib usage.
Eliminates overengineering while maintaining all core functionality.


## Table of Contents
- [`PlotStyle`](./dr_gen.analyze.visualization#class-plotstyle)
- [`get_color_palette`](./dr_gen.analyze.visualization#function-get-color-palette)
- [`merge_defaults`](./dr_gen.analyze.visualization#function-merge-defaults)
- [`plot_cdf`](./dr_gen.analyze.visualization#function-plot-cdf)
- [`plot_grid`](./dr_gen.analyze.visualization#function-plot-grid)
- [`plot_histogram`](./dr_gen.analyze.visualization#function-plot-histogram)
- [`plot_lines`](./dr_gen.analyze.visualization#function-plot-lines)
- [`plot_metric_group`](./dr_gen.analyze.visualization#function-plot-metric-group)
- [`plot_splits`](./dr_gen.analyze.visualization#function-plot-splits)
- [`plot_summary`](./dr_gen.analyze.visualization#function-plot-summary)
- [`plot_training_metrics`](./dr_gen.analyze.visualization#function-plot-training-metrics)
- [`sample_data`](./dr_gen.analyze.visualization#function-sample-data)
- [`set_plot_defaults`](./dr_gen.analyze.visualization#function-set-plot-defaults)


**Global Variables**
---------------
- **COLORBLIND_COLORS**
- **PAUL_TOL_COLORS**
- **CATEGORICAL_COLORS**
- **DEFAULT_STYLE**

---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/visualization.py#L57"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>function</kbd> `get_color_palette`

```python
get_color_palette(n_colors: int = 8, palette: str = 'colorblind') → list[str]
```

Get a colorblind-safe color palette.


**Args:**

- <b>`n_colors`</b>: Number of colors needed
- <b>`palette`</b>: Palette name ('colorblind', 'paul_tol', 'categorical')


**Returns:**

List of hex color codes



---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/visualization.py#L86"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>function</kbd> `plot_metric_group`

```python
plot_metric_group(
    metric_dfs: dict[str, DataFrame] | dict[Any, dict[str, DataFrame]],
    x_metric: str = 'epoch',
    y_metrics: str | list[str] = 'train_loss',
    db: ExperimentDB | None = None,
    group_descriptions: str | dict[Any, str] | None = None,
    color_by: str = 'metric',
    linestyle_by: str = 'group',
    group_hparams: dict[Any, dict[str, Any]] | None = None,
    figsize: tuple[float, float] = (8, 5),
    show_individual_runs: bool = True,
    individual_alpha: float = 0.25,
    individual_linewidth: float = 0.8,
    color_scheme: str = 'colorblind',
    mean_linewidth: float = 2.5,
    std_band: bool = True,
    std_alpha: float = 0.15,
    grid: bool = True,
    grid_alpha: float = 0.2,
    legend: bool = True,
    legend_loc: str | tuple[float, float] = 'best',
    separate_legends: bool = False,
    color_legend_title: str | None = None,
    linestyle_legend_title: str | None = None,
    color_legend_loc: str | tuple[float, float] = 'upper right',
    linestyle_legend_loc: str | tuple[float, float] = 'lower right',
    xlabel: str | None = None,
    ylabel: str | None = None,
    title: str | None = None,
    xlim: tuple[float, float] | None = None,
    ylim: tuple[float, float] | None = None,
    xscale: str = 'linear',
    yscale: str = 'linear',
    return_fig: bool = False,
    publication_style: bool = True
) → Figure | None
```

Plot metrics for one or more groups of runs with mean and standard deviation.

Colors and linestyles can be controlled to distinguish either metrics, groups, or specific
hyperparameters. Individual runs and std band use the same color/style as the mean.


**Args:**

- <b>`metric_dfs`</b>: Either:
    - Dict of metric DataFrames (single group)
    - Dict of dicts where keys are group IDs and values are metric DataFrames
- <b>`x_metric`</b>: Name of metric to use for x-axis
- <b>`y_metrics`</b>: Single metric name or list of metric names for y-axis
- <b>`db`</b>: ExperimentDB instance for display name lookups (optional)
- <b>`group_descriptions`</b>: Either:
    - String description for single group
    - Dict mapping group IDs to descriptions
    - None to auto-generate or omit
- <b>`color_by`</b>: What to use for color differentiation:
- <b>`- 'metric'`</b>: Different colors for different metrics (default)
- <b>`- 'group'`</b>: Different colors for different groups
- <b>`- 'none'`</b>: Use single color (first color from color_scheme)
- <b>`- hyperparameter name`</b>: Different colors for different values of that hyperparameter
- <b>`linestyle_by`</b>: What to use for linestyle differentiation:
- <b>`- 'group'`</b>: Different linestyles for different groups (default)
- <b>`- 'metric'`</b>: Different linestyles for different metrics
- <b>`- 'none'`</b>: Use single linestyle (solid line)
- <b>`- hyperparameter name`</b>: Different linestyles for different values of that hyperparameter
- <b>`group_hparams`</b>: Dict mapping group IDs to hyperparameter dictionaries.
    Required when color_by or linestyle_by is a hyperparameter name.
    Can be obtained from GroupedRuns.group_keys_to_dicts()
- <b>`figsize`</b>: Figure size tuple
- <b>`show_individual_runs`</b>: Whether to plot individual run traces
- <b>`individual_alpha`</b>: Transparency for individual runs
- <b>`individual_linewidth`</b>: Line width for individual runs
- <b>`color_scheme`</b>: Name of color palette to use ('colorblind', 'paul_tol', 'categorical')
- <b>`mean_linewidth`</b>: Line width for mean line
- <b>`std_band`</b>: Whether to show standard deviation band
- <b>`std_alpha`</b>: Transparency for std band
- <b>`grid`</b>: Whether to show grid
- <b>`grid_alpha`</b>: Grid transparency
- <b>`legend`</b>: Whether to show legend
- <b>`legend_loc`</b>: Legend location ('best', 'upper right', 'upper left', 'lower left',
           'lower right', 'right', 'center left', 'center right', 'lower center',
           'upper center', 'center', or (x, y) tuple for custom position)
- <b>`separate_legends`</b>: Enable dual legend mode (user must explicitly set to True)
- <b>`color_legend_title`</b>: Title for color legend (when separate_legends=True)
- <b>`linestyle_legend_title`</b>: Title for linestyle legend (when separate_legends=True)
- <b>`color_legend_loc`</b>: Position for color legend (when separate_legends=True)
- <b>`linestyle_legend_loc`</b>: Position for linestyle legend (when separate_legends=True)
- <b>`xlabel`</b>: Override x-axis label (uses display name if None)
- <b>`ylabel`</b>: Override y-axis label (uses display name if None)
- <b>`title`</b>: Override title (auto-generated if None)
- <b>`xlim`</b>: X-axis limits
- <b>`ylim`</b>: Y-axis limits
- <b>`xscale`</b>: X-axis scale ('linear', 'log', etc.)
- <b>`yscale`</b>: Y-axis scale ('linear', 'log', etc.)
- <b>`return_fig`</b>: If True, return the figure instead of showing it
- <b>`publication_style`</b>: If True, apply publication-quality styling


**Returns:**

Figure if return_fig=True, otherwise None


**Example:**

```python
    >>> # Single group, single metric
>>> metric_dfs = db.run_group_to_metric_dfs(runs, ["epoch", "train_loss"])
>>> plot_metric_group(
...     metric_dfs,
...     x_metric="epoch",
...     y_metrics="train_loss",
...     db=db,
...     group_descriptions="LR=0.01, WD=1e-4",
... )

>>> # Single group, multiple metrics
>>> plot_metric_group(
...     metric_dfs,
...     x_metric="epoch",
...     y_metrics=["train_loss", "val_loss"],
...     db=db,
... )

>>> # Multiple groups, single metric
>>> all_groups = {}
>>> for group_key, runs in run_groups.items():
...     all_groups[group_key] = db.run_group_to_metric_dfs(runs, metrics)
>>> plot_metric_group(
...     all_groups,
...     x_metric="epoch",
...     y_metrics="train_loss",
...     db=db,
...     group_descriptions={
...         group_key: db.format_group_description(group_key)
...         for group_key in all_groups
...     },
... )
    ```



---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/visualization.py#L795"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>function</kbd> `plot_training_metrics`

```python
plot_training_metrics(
    df: DataFrame,
    title: str = '',
    xlog: bool = False,
    ylog: bool = False,
    xrange: tuple[float, float] | None = None,
    yrange_train_loss: tuple[float, float] | None = None,
    yrange_val_loss: tuple[float, float] | None = None,
    yrange_acc: tuple[float, float] | None = None,
    figsize: tuple[float, float] = (17.0, 4.2),
    leave_space_for_legend: float = 0.1,
    df_std: DataFrame | None = None,
    hbar2: float = 50
) → None
```

Draw the *four* panels (train‑loss, val‑loss, train‑acc, val‑acc) with
colour = learning‑rate and linestyle = weight‑decay.  The mapping is derived
automatically from whatever unique values appear in the dataframe.

Parameters
----------
df : tidy dataframe with at least the columns produced by
     `make_mock_cifar_df`.
df_std : dataframe with the same structure as df, containing std dev for each metric.



---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/visualization.py#L1047"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>function</kbd> `merge_defaults`

```python
merge_defaults(**kwargs: Unpack[PlotStyle]) → PlotStyle
```

Merge user kwargs with defaults.



---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/visualization.py#L1052"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>function</kbd> `sample_data`

```python
sample_data(data: list[Any], n: int | None = None) → list[Any]
```

Randomly sample n items from data.



---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/visualization.py#L1059"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>function</kbd> `plot_lines`

```python
plot_lines(
    curves: list[float] | list[list[float]],
    sample: int | None = None,
    ax: Axes | None = None,
    **kwargs: Unpack[PlotStyle]
) → Figure
```

Plot line curves - single curve or multiple curves.



---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/visualization.py#L1109"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>function</kbd> `plot_histogram`

```python
plot_histogram(
    vals: list[float] | list[list[float]],
    ax: Axes | None = None,
    **kwargs: Unpack[PlotStyle]
) → Figure
```

Plot histogram - single or multiple distributions.



---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/visualization.py#L1160"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>function</kbd> `plot_cdf`

```python
plot_cdf(
    vals1: list[float],
    vals2: list[float],
    ax: Axes | None = None,
    **kwargs: Unpack[PlotStyle]
) → Figure
```

Plot comparative CDFs with KS statistics.



---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/visualization.py#L1208"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>function</kbd> `plot_splits`

```python
plot_splits(
    split_data: list[list[list[float]]],
    splits: list[str] | None = None,
    ax: Axes | None = None,
    **kwargs: Unpack[PlotStyle]
) → Figure
```

Plot training/validation/eval splits with different line styles.



---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/visualization.py#L1269"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>function</kbd> `plot_summary`

```python
plot_summary(
    curves_list: list[list[float]],
    uncertainty: str = 'std',
    ax: Axes | None = None,
    **kwargs: Unpack[PlotStyle]
) → Figure
```

Plot mean curve with uncertainty bands (std, sem, or minmax).



---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/visualization.py#L1340"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>function</kbd> `plot_grid`

```python
plot_grid(
    plot_func: Callable[, Any],
    data_list: list[Any],
    subplot_shape: tuple[int, int] | None = None,
    sample: int | None = None,
    **kwargs: Unpack[PlotStyle]
) → Figure
```

Create grid of plots using specified plot function.



---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/visualization.py#L1383"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>function</kbd> `set_plot_defaults`

```python
set_plot_defaults(**kwargs: Unpack[PlotStyle]) → None
```

Update default plotting style.



---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/visualization.py#L1019"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>class</kbd> `PlotStyle`
Type definition for plot styling options.








---

_This file was automatically generated via [lazydocs](https://github.com/ml-tooling/lazydocs)._
