---
title: dr_gen
---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/grouped_runs.py"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

# <kbd>module</kbd> `analyze.grouped_runs`
GroupedRuns class for managing experiment run grouping and filtering operations.


## Table of Contents
- [`GroupedRuns`](./dr_gen.analyze.grouped_runs#class-groupedruns)
	- [`__init__`](./dr_gen.analyze.grouped_runs#constructor---init--)
	- [`describe_groups`](./dr_gen.analyze.grouped_runs#method-describe-groups)
	- [`filter`](./dr_gen.analyze.grouped_runs#method-filter)
	- [`from_db`](./dr_gen.analyze.grouped_runs#classmethod-from-db)
	- [`get_group_info`](./dr_gen.analyze.grouped_runs#method-get-group-info)
	- [`get_plotting_data`](./dr_gen.analyze.grouped_runs#method-get-plotting-data)
	- [`group_keys_to_dicts`](./dr_gen.analyze.grouped_runs#method-group-keys-to-dicts)
	- [`matching`](./dr_gen.analyze.grouped_runs#method-matching)
	- [`to_metric_dfs`](./dr_gen.analyze.grouped_runs#method-to-metric-dfs)




---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/grouped_runs.py#L15"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>class</kbd> `GroupedRuns`
Immutable class representing grouped experiment runs with filtering and data access operations.

This class encapsulates runs grouped by hyperparameters and provides a clean API for:
- Filtering groups by hyperparameter values or specific combinations
- Converting to metric DataFrames for analysis and plotting
- Describing groups with formatted hyperparameter descriptions

Operations are immutable - each filtering operation returns a new GroupedRuns instance.


<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/grouped_runs.py#L26"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

### <kbd>constructor</kbd> `__init__`

```python
GroupedRuns(
    groups: 'dict[tuple, list[Run]]',
    hpm_names: 'list[str]',
    db: 'ExperimentDB'
) → None
```

Initialize GroupedRuns.


**Args:**

- <b>`groups`</b>: Dict mapping hyperparameter value tuples to lists of runs
- <b>`hpm_names`</b>: List of hyperparameter names corresponding to tuple positions
- <b>`db`</b>: ExperimentDB instance for accessing display names and formatting





---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/grouped_runs.py#L203"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

### <kbd>method</kbd> `describe_groups`

```python
describe_groups(
    exclude_from_display: 'list[str] | None' = None
) → dict[tuple, str]
```

Get formatted descriptions for each group.


**Args:**

- <b>`exclude_from_display`</b>: Hyperparameters to exclude from display strings.
                    If None, uses db.config.grouping_exclude_hpm_display_names


**Returns:**

Dict mapping group keys to formatted description strings


**Example:**

```python
    >>> descriptions = grouped.describe_groups()
>>> for key, desc in descriptions.items():
...     print(f"{key}: {desc}")
(0.01, 0.0001): Learning Rate: 1e-02, Weight Decay: 1e-04
    ```


---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/grouped_runs.py#L64"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

### <kbd>method</kbd> `filter`

```python
filter(
    include: 'dict[str, list[Any]] | None' = None,
    exclude: 'dict[str, list[Any]] | None' = None,
    include_pairs: 'list[tuple] | None' = None,
    exclude_pairs: 'list[tuple] | None' = None,
    min_runs: 'int | None' = None,
    max_runs: 'int | None' = None
) → GroupedRuns
```

Filter groups based on hyperparameter values and run counts.


**Args:**

- <b>`include`</b>: Dict of hpm_name -> list of values to include
- <b>`exclude`</b>: Dict of hpm_name -> list of values to exclude
- <b>`include_pairs`</b>: List of tuples representing specific combinations to include
- <b>`exclude_pairs`</b>: List of tuples representing specific combinations to exclude
- <b>`min_runs`</b>: Minimum number of runs required per group (groups with fewer runs are excluded)
- <b>`max_runs`</b>: Maximum number of runs allowed per group (groups with more runs are excluded)


**Returns:**

New GroupedRuns instance with filtered groups


**Example:**

```python
    >>> # Keep only specific learning rates, exclude high weight decay
>>> filtered = grouped.filter(
...     include={"optim.lr": [0.01, 0.03]},
...     exclude={"optim.weight_decay": [0.01]},
... )
>>> # Filter to groups with at least 3 runs
>>> well_sampled = grouped.filter(min_runs=3)
    ```


---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/grouped_runs.py#L43"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

### <kbd>classmethod</kbd> `from_db`

```python
from_db(
    db: 'ExperimentDB',
    exclude_hpms: 'list[str] | None' = None
) → GroupedRuns
```

Create GroupedRuns from ExperimentDB by grouping active runs.


**Args:**

- <b>`db`</b>: ExperimentDB instance
- <b>`exclude_hpms`</b>: Hyperparameters to exclude from grouping. If None, uses
             db.config.grouping_exclude_hpms


**Returns:**

New GroupedRuns instance


**Example:**

```python
    >>> grouped = GroupedRuns.from_db(db)
>>> print(f"{len(grouped)} groups found")
    ```


---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/grouped_runs.py#L298"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

### <kbd>method</kbd> `get_group_info`

```python
get_group_info() → dict[str, Any]
```

Get summary information about the grouped runs.


**Returns:**

    Dict with summary statistics about the groups


---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/grouped_runs.py#L228"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

### <kbd>method</kbd> `get_plotting_data`

```python
get_plotting_data(
    metrics: 'list[str]',
    exclude_from_display: 'list[str] | None' = None
) → tuple[dict[tuple, dict[str, DataFrame]], dict[tuple, str], dict[tuple, dict[str, Any]]]
```

Get all data needed for plotting with color/linestyle control.

This is a convenience method that returns metric DataFrames, group descriptions,
and hyperparameter dictionaries in one call - everything needed for plot_metric_group().


**Args:**

- <b>`metrics`</b>: List of metric names to extract
- <b>`exclude_from_display`</b>: Hyperparameters to exclude from display strings


**Returns:**

Tuple of (metric_dfs, group_descriptions, group_hparams) where:
- <b>`- metric_dfs`</b>: Output of to_metric_dfs()
- <b>`- group_descriptions`</b>: Output of describe_groups()
- <b>`- group_hparams`</b>: Output of group_keys_to_dicts()


**Example:**

```python
    >>> metric_dfs, descriptions, hparams = grouped.get_plotting_data(
...     ["train_loss", "epoch"]
... )
>>> plot_metric_group(
...     metric_dfs,
...     x_metric="epoch",
...     y_metrics="train_loss",
...     db=db,
...     group_descriptions=descriptions,
...     group_hparams=hparams,
...     color_by="group",  # Use colors to distinguish groups instead of metrics
... )
    ```


---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/grouped_runs.py#L270"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

### <kbd>method</kbd> `group_keys_to_dicts`

```python
group_keys_to_dicts(
    use_display_names: 'bool' = False
) → dict[tuple, dict[str, Any]]
```

Convert group keys to hyperparameter dictionaries.


**Args:**

- <b>`use_display_names`</b>: If True, use display names as dict keys


**Returns:**

Dict mapping group keys to hyperparameter dictionaries


**Example:**

```python
    >>> hpm_dicts = grouped.group_keys_to_dicts()
>>> # Technical names
>>> print(
...     hmp_dicts[(0.01, 0.0001)]
... )  # {'optim.lr': 0.01, 'optim.weight_decay': 0.0001}
>>> # Display names
>>> display_dicts = grouped.group_keys_to_dicts(use_display_names=True)
>>> print(
...     display_dicts[(0.01, 0.0001)]
... )  # {'Learning Rate': 0.01, 'Weight Decay': 0.0001}
    ```


---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/grouped_runs.py#L116"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

### <kbd>method</kbd> `matching`

```python
matching(
    base_hpms: 'dict[str, Any]',
    varying_hpms: 'list[str] | None' = None
) → GroupedRuns
```

Filter to groups that match specific base hyperparameters.

Useful for getting all combinations of specific hyperparameters (e.g., lr, wd)
while fixing others (e.g., model architecture, batch size).


**Args:**

- <b>`base_hpms`</b>: Dict of hyperparameters that must match exactly
- <b>`varying_hpms`</b>: List of hyperparameters that are allowed to vary.
             If None, uses ['optim.lr', 'optim.weight_decay']


**Returns:**

New GroupedRuns instance with groups matching base_hpms,
grouped by varying_hpms


**Example:**

```python
    >>> # Get all (lr, wd) combinations for specific model config
>>> lr_wd_groups = grouped.matching(
...     base_hpms={"model.architecture": "resnet18", "batch_size": 128},
...     varying_hpms=["optim.lr", "optim.weight_decay"],
... )
    ```


---

<a href="https://github.com/drothermel/%24%7BREPO%7D/blob/main/src/dr_gen/analyze/grouped_runs.py#L175"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

### <kbd>method</kbd> `to_metric_dfs`

```python
to_metric_dfs(metrics: 'list[str]') → dict[tuple, dict[str, DataFrame]]
```

Convert groups to metric DataFrames.


**Args:**

- <b>`metrics`</b>: List of metric names to extract


**Returns:**

Dict mapping group keys to metric DataFrames:
{
    group_key: {
- <b>`'metric_name'`</b>: DataFrame with columns for each run/seed,
...
},
...
}


**Example:**

```python
    >>> metric_dfs = grouped.to_metric_dfs(["train_loss", "val_acc", "epoch"])
>>> # Access specific group's train loss
>>> group_key = list(metric_dfs.keys())[0]
>>> train_loss_df = metric_dfs[group_key]["train_loss"]
>>> print(train_loss_df.head())
    ```





---

_This file was automatically generated via [lazydocs](https://github.com/ml-tooling/lazydocs)._
